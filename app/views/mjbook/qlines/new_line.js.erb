$('table#<%=@line.id%>').after('<%= escape_javascript(render :partial => 'line_row', locals: { line: @new_line }) %>');

$('table#group_sub_<%= @line.qgroup_id %>').find('.line_vat').html('<%= pounds(@qgroup.sub_vat) %>');
$('table#group_sub_<%= @line.qgroup_id %>').find('.line_price').html('<%= pounds(@qgroup.sub_price) %>');
  
$('table#total_<%= @line.qgroup.quote_id %>').find('.total_vat').html('<%= pounds(@quote.total_vat) %>');
$('table#total_<%= @line.qgroup.quote_id %>').find('.total_price').html('<%= pounds(@quote.total_price) %>');


// show/hide menu and mob menu link
    $('table.line_table').on({
        mouseenter:function(){ 
            $(this).css('background-color', '#efefef');
            $(this).find('td.line_menu').css('visibility', 'visible');
            $(this).find('td.line_menu_mob').css('visibility', 'visible');
    },
        mouseleave:function(){ 
            $(this).css('background-color', '#fff');
            $(this).find('td.line_menu').css('visibility', 'hidden');
            $(this).find('td.line_menu_mob').css('visibility', 'hidden')
        }
    });

    
// show/hide mob menu
    $('.line_menu_mob').click(function (){
        $(this).closest('table').find('.mob_menu_popup').toggle();
    });
 
    $('tr.mob_menu_popup').mouseleave(function (){
        $(this).hide();
    });


// specline linetype edit
    $(document).on('click','.submittable2', function() {
     $(this).parents('form:first').submit();
       return false;
    });




//$('span#<%= @new_line.id%>').mouseover(function(){
    var line_id = 103;   
        $('span#103').editable('http://localhost:3000/mjbook/qlines/103/update_quantity', {
            id: line_id, width: ($(this).width() +10)+'px',
            type: 'text',
            ajaxoptions: {dataType: 'script'},
            onblur: 'submit',
            method: 'PUT',
            indicator: 'Saving..',
            submitdata: {_method: 'put', 'id': '<%= @line.id%>', authenticity_token: AUTH_TOKEN}
        }); 
//    });


//$('span#<%= @new_line.id%>').trigger('click');


// update rate  
    $('.qline_rate').mouseover(function(){
    var line_id = $(this).attr('id');
        $(this).editable('http://localhost:3000/mjbook/qlines/'+line_id+'/update_rate', {
            id: line_id, width: ($(this).width() +10)+'px',
            type: 'text',
            ajaxoptions: {dataType: 'script'},
            onblur: 'submit',
            method: 'PUT',
            indicator: 'Saving..',
            submitdata: {_method: 'put', 'id': '<%= @line.id%>', authenticity_token: AUTH_TOKEN}
        });     
    });
